{% extends "base.html" %}
{% block title %}Documents — Ai{% endblock %}
{% block page_title %}Knowledge Base{% endblock %}

{% block topbar_actions %}
  <a href="{{ url_for('add_document') }}" class="btn btn-primary">
    <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
    Add Document
  </a>
{% endblock %}

{% block extra_styles %}
<style>
  .docs-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 18px; }
  .doc-card {
    background: var(--glass); backdrop-filter: blur(16px);
    border: 1px solid var(--glass-border); border-radius: 20px;
    padding: 24px; display: flex; flex-direction: column;
    transition: transform .2s, box-shadow .2s;
  }
  .doc-card:hover { transform: translateY(-2px); box-shadow: 0 12px 32px rgba(180,100,80,.12); }
  .doc-title {
    font-family: 'Cormorant Garamond', serif; font-size: 1.25rem;
    font-weight: 400; color: var(--warm-dark); margin-bottom: 8px; line-height: 1.3;
  }
  .doc-preview {
    font-size: .83rem; color: var(--text-mid); line-height: 1.6;
    flex: 1; display: -webkit-box; -webkit-line-clamp: 4;
    -webkit-box-orient: vertical; overflow: hidden; margin-bottom: 16px;
  }
  .doc-meta { font-size: .72rem; color: var(--text-soft); margin-bottom: 14px; }
  .doc-actions { display: flex; gap: 8px; margin-top: auto; }
  .empty-state {
    text-align: center; padding: 80px 40px;
    background: var(--glass); backdrop-filter: blur(16px);
    border: 1px dashed rgba(200,180,170,.5); border-radius: 20px;
    color: var(--text-soft);
  }
  .empty-state h3 { font-family: 'Cormorant Garamond', serif; font-size: 1.6rem; font-weight: 300; margin-bottom: 8px; color: var(--warm-dark); }
  .empty-state p { font-size: .88rem; margin-bottom: 20px; }
  .doc-count { font-size: .82rem; color: var(--text-soft); margin-bottom: 20px; }
</style>
{% endblock %}

{% block content %}
{% if docs %}
  <p class="doc-count">{{ docs|length }} document{% if docs|length != 1 %}s{% endif %} in your knowledge base</p>
  <div class="docs-grid">
    {% for doc in docs %}
    <div class="doc-card">
      <div class="doc-title">{{ doc.title }}</div>
      <div class="doc-preview">{{ doc.content }}</div>
      <div class="doc-meta">
        Updated {{ doc.updated_at.strftime('%b %d, %Y') }} ·
        {{ doc.content|length }} chars
      </div>
      <div class="doc-actions">
        <a href="{{ url_for('edit_document', doc_id=doc.id) }}" class="btn btn-ghost" style="flex:1; justify-content:center;">
          <svg viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
          Edit
        </a>
        <form method="POST" action="{{ url_for('delete_document', doc_id=doc.id) }}"
              onsubmit="return confirm('Delete this document?')">
          <button type="submit" class="btn btn-danger">
            <svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6M14 11v6"/></svg>
            Delete
          </button>
        </form>
      </div>
    </div>
    {% endfor %}
  </div>
{% else %}
  <div class="empty-state">
    <h3>No documents yet</h3>
    <p>Add documents to build your AI knowledge base. The chatbot will use them to answer your questions.</p>
    <a href="{{ url_for('add_document') }}" class="btn btn-primary">
      <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
      Add your first document
    </a>
  </div>
{% endif %}
{% endblock %}
