{% extends "base.html" %}
{% block title %}{{ action }} Document — Ai{% endblock %}
{% block page_title %}{{ action }} Document{% endblock %}

{% block topbar_actions %}
  <a href="{{ url_for('documents') }}" class="btn btn-ghost">
    <svg viewBox="0 0 24 24" style="width:15px;height:15px;stroke:currentColor;fill:none;stroke-width:2;"><polyline points="15 18 9 12 15 6"/></svg>
    Back to Documents
  </a>
{% endblock %}

{% block extra_styles %}
<style>
  .form-card {
    max-width: 680px;
    background: var(--glass); backdrop-filter: blur(16px);
    border: 1px solid var(--glass-border); border-radius: 24px;
    padding: 36px 40px;
    box-shadow: 0 8px 32px rgba(180,100,80,.08);
  }
  .form-card h2 {
    font-family: 'Cormorant Garamond', serif; font-size: 1.6rem;
    font-weight: 300; margin-bottom: 6px; color: var(--warm-dark);
  }
  .form-card .subtitle { font-size: .84rem; color: var(--text-soft); margin-bottom: 30px; }
  textarea.form-control { min-height: 260px; }
  .form-actions { display: flex; gap: 12px; margin-top: 8px; }
  .char-count { font-size: .75rem; color: var(--text-soft); text-align: right; margin-top: 4px; }
</style>
{% endblock %}

{% block content %}
<div class="form-card">
  <h2>{{ action }} Document</h2>
  <p class="subtitle">
    {% if action == 'Add' %}
      Add content to your knowledge base. The AI will use this to answer questions.
    {% else %}
      Update the document content below.
    {% endif %}
  </p>

  <form method="POST">
    <div class="form-group">
      <label class="form-label">Title</label>
      <input type="text" name="title" class="form-control"
             placeholder="e.g. Company FAQ, Product Manual, Policy Document…"
             value="{{ doc.title if doc else '' }}" required>
    </div>
    <div class="form-group">
      <label class="form-label">Content</label>
      <textarea name="content" id="contentArea" class="form-control"
                placeholder="Paste or type your document content here…"
                required>{{ doc.content if doc else '' }}</textarea>
      <div class="char-count"><span id="charCount">0</span> characters</div>
    </div>
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">
        <svg viewBox="0 0 24 24"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
        {{ 'Save Document' if action == 'Add' else 'Update Document' }}
      </button>
      <a href="{{ url_for('documents') }}" class="btn btn-ghost">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}

{% block scripts %}
<script>
  const ta = document.getElementById('contentArea');
  const cc = document.getElementById('charCount');
  const update = () => cc.textContent = ta.value.length.toLocaleString();
  ta.addEventListener('input', update);
  update();
</script>
{% endblock %}
